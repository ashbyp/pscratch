tdata ="""#.#####################
#.......#########...###
#######.#########.#.###
###.....#.>.>.###.#.###
###v#####.#v#.###.#.###
###.>...#.#.#.....#...#
###v###.#.#.#########.#
###...#.#.#.......#...#
#####.#.#.#######.#.###
#.....#.#.#.......#...#
#.#####.#.#.#########v#
#.#...#...#...###...>.#
#.#.#v#######v###.###v#
#...#.>.#...>.>.#.###.#
#####v#.#.###v#.#.###.#
#.....#...#...#.#.#...#
#.#########.###.#.#.###
#...###...#...#...#.###
###.###.#.###v#####v###
#...#...#.#.>.>.#.>.###
#.###.###.#.###.#.#v###
#.....###...###...#...#
#####################.#"""

data="""#.###########################################################################################################################################
#.#####.....................#.............#.......#...#...###...###.....#.......#...###...#...#.....#...............#...#.........#...#...###
#.#####.###################.#.###########.#.#####.#.#.#.#.###.#.###.###.#.#####.#.#.###.#.#.#.#.###.#.#############.#.#.#.#######.#.#.#.#.###
#...###.#...#...............#...........#.#.#.....#.#.#.#.###.#.#...#...#...#...#.#.#...#...#.#...#.#.....#.........#.#...#.....#.#.#.#.#.###
###.###.#.#.#.#########################.#.#.#.#####.#.#.#.###.#.#.###.#####.#.###.#.#.#######.###.#.#####.#.#########.#####.###.#.#.#.#.#.###
###.....#.#.#.......###...#...#...#...#.#.#.#.......#.#.#...#.#.#...#...#...#...#.#.#.......#.#...#.>.>...#.....#...#.....#...#...#.#.#.#.###
#########.#.#######.###.#.#.#.#.#.#.#.#.#.#.#########.#.###.#.#.###.###.#.#####.#.#.#######.#.#.#####v#########.#.#.#####.###.#####.#.#.#.###
#.........#.........#...#.#.#.#.#.#.#...#...#.........#...#...#...#.#...#...#...#.#.###.....#.#.#.....#.........#.#.#...#.#...#...#.#...#...#
#.###################.###.#.#.#.#.#.#########.###########.#######.#.#.#####.#.###.#.###.#####.#.#.#####.#########.#.#.#.#.#.###.#.#.#######.#
#.#...#...#...###...#...#.#.#.#.#.#.....#...#.#...#.>.>...#...#...#.#...#...#...#.#...#.....#...#.....#...#.....#.#.#.#.#.#.....#.#.....#...#
#.#.#.#.#.#.#.###.#.###.#.#.#.#.#.#####.#.#.#.#.#.#.#v#####.#.#.###.###.#.#####.#.###.#####.#########.###.#.###.#.#.#.#.#.#######.#####.#.###
#...#...#...#...#.#...#.#.#.#.#.#.#...#...#.#.#.#.#.#.#...#.#...###...#.#.#.....#.#...#.....#...#.....###...#...#.#.#.#...#.......#####.#...#
###############.#.###.#.#.#.#.#.#.#.#.#####.#.#.#.#.#.#.#.#.#########.#.#.#.#####.#.###.#####.#.#.###########.###.#.#.#####.###########.###.#
#...............#.#...#.#.#.#...#.#.#.#.....#...#...#...#.#.#...#...#.#.#.#.>.>.#.#.#...#.....#.#.......#.....#...#.#.#.....###...###...#...#
#.###############.#.###.#.#.#####.#.#.#.#################.#.#.#.#.#.#.#.#.###v#.#.#.#.###.#####.#######.#.#####.###.#.#.#######.#.###.###.###
#...#...#...#...#.#.###.#.#.....#.#.#.#.......#...........#...#...#.#.#.#.#...#...#.#...#.#...#.........#.#...#...#.#.#.#...###.#.###.#...###
###.#.#.#.#v#.#.#.#.###.#.#####.#.#.#.#######.#.###################.#.#.#.#.#######.###.#.#.#.###########.#.#.###.#.#.#.#.#.###.#.###.#.#####
#...#.#...#.>.#...#...#.#...#...#...#...>.>.#.#.#.................#.#.#.#.#.....###.....#...#...#.......#.#.#.#...#.#.#.#.#.#...#.#...#...###
#.###.#####v#########.#.###.#.###########v#.#.#.#.###############.#.#.#.#.#####.###############.#.#####.#.#.#.#.###.#.#.#.#.#.###.#.#####.###
#.....#...#.#...#...#.#...#...#...#.......#...#...###.............#...#.#.....#...#...#...#####...#.....#...#.#...#...#.#.#.#...#...#####...#
#######.#.#.#.#.#.#.#.###.#####.#.#.#################.#################.#####.###.#.#.#.#.#########.#########.###.#####.#.#.###.###########.#
#.......#...#.#...#.#.#...#.....#.#.............#...#...........#...#...#.....###...#...#.......#...#...###...#...#.....#.#.....#.....#...#.#
#.###########.#####.#.#.###.#####.#############.#.#.###########.#.#.#.###.#####################.#.###.#.###.###.###.#####.#######.###.#.#.#.#
#.....#.......#...#.#...###.....#.#...#.....#...#.#...#.........#.#.#...#.#.....................#...#.#...#...#.###.......#...###...#...#...#
#####.#.#######.#.#.###########.#.#.#.#.###.#.###.###.#.#########.#.###.#.#.#######################.#.###.###.#.###########.#.#####.#########
#...#...#...#...#...###...#.....#...#.#...#.#.###...#.#.....#.....#.###...#.............#...#######...###...#.#.#...#.......#.#...#.........#
#.#.#####.#.#.#########.#.#.#########.###.#.#.#####.#.#####.#.#####.###################.#.#.###############.#.#.#.#.#.#######.#.#.#########.#
#.#.#.....#.#.......#...#.#.........#...#.#.#...#...#.......#.#.....#.......#...........#.#...#.....#...###.#...#.#.#.......#.#.#.....#...#.#
#.#.#.#####.#######.#.###.#########.###.#.#.###.#.###########.#.#####.#####.#.###########.###.#.###.#.#.###.#####.#.#######.#.#v#####.#.#.#.#
#.#...#...#...#.....#...#.#.........###.#.#.#...#.#...........#.....#.....#.#...#.........#...#...#...#.....#...#.#...#...#.#.>.#...#...#.#.#
#.#####.#.###.#.#######.#.#.###########.#.#.#.###.#.###############.#####.#.###.#.#########.#####.###########.#.#.###.#.#.#.###v#.#.#####.#.#
#.......#...#...#.......#.#...........#...#...#...#.#...............#...#.#.###...#.........#...#...........#.#...###...#.#.###...#.....#...#
###########.#####.#######.###########.#########.###.#.###############.#.#.#.#######.#########.#.###########.#.###########.#.###########.#####
#...........#...#.....#...###.........###...###.....#...........#.....#.#.#.#.....#...#...###.#.#...#.......#.........#...#.#...........#...#
#.###########.#v#####.#.#####v###########.#.###################.#.#####.#.#.#.###.###.#.#.###.#.#.#.#.###############.#.###.#.###########.#.#
#.#...#...#...#.>...#.#.#...>.>.###.....#.#.###...#...#.........#...#...#.#.#.#...#...#.#...#.#.#.#.#.......#.........#.#...#.#...........#.#
#.#.#.#.#.#.###v###.#.#.#.###v#.###.###.#.#.###.#.#.#.#.###########.#.###.#.#.#.###v###.###.#.#.#.#.#######.#.#########.#.###.#.###########.#
#...#...#.#...#...#...#...###.#...#.#...#.#.#...#.#.#.#.......#...#.#...#.#.#.#.#.>.>.#.#...#.#.#.#.#...###.#.........#.#.#...#.#...........#
#########.###.###.###########.###.#.#.###.#.#.###.#.#.#######.#.#.#.###.#.#.#.#.#.#v#.#.#.###.#.#.#.#.#.###v#########.#.#.#.###.#.###########
#...#.....#...###...###.......###.#.#.###.#.#...#.#.#.#...#...#.#.#...#.#.#...#...#.#.#.#...#.#.#.#.#.#...>.>.#.....#.#...#.....#...........#
#.#.#.#####.#######.###.#########.#.#.###.#.###.#.#.#.#.#.#v###.#.###.#.#.#########.#.#.###.#.#.#.#.#.#####v#.#.###.#.#####################.#
#.#...#.....#...###...#.......#...#.#...#.#.#...#.#.#.#.#.>.>.#.#.#...#...#.......#.#.#.###.#.#.#.#...###...#.#...#.#.#...................#.#
#.#####.#####.#.#####.#######.#.###.###.#.#.#.###.#.#.#.###v#.#.#.#.#######.#####.#.#.#.###.#.#.#.#######.###.###.#.#.#.#################.#.#
#.......###...#.......#.......#.....#...#.#...#...#.#.#.#...#...#.#.......#.....#...#.#...#.#.#...###.....###.....#...#.................#...#
###########.###########.#############.###.#####.###.#.#.#.#######.#######.#####.#####.###.#.#.#######.#################################.#####
#.........#.........#...#...........#...#.....#...#.#...#.......#.#.......#...#.....#.#...#.#.###...#...........#...###...#...#.........#...#
#.#######.#########.#.###.#########.###.#####.###.#.###########.#.#.#######.#.#####.#.#.###.#.###.#.###########.#.#.###.#.#.#.#.#########.#.#
#.......#...........#...#.#.........#...#.....#...#.#...#.......#...#.......#.......#...#...#.#...#.....#.......#.#.###.#.#.#.#...........#.#
#######.###############.#.#.#########.###.#####.###.#.#.#.###########.###################.###.#.#######.#.#######.#.###.#.#.#.#############.#
#.......#...#...#.....#.#.#...#...###...#.#...#.....#.#.#...........#...#.............###.....#.......#...###.....#...#.#...#.#.........#...#
#.#######.#.#.#.#.###.#.#.###.#.#.#####.#.#.#.#######.#.###########.###.#.###########.###############.#######.#######.#.#####.#.#######.#.###
#.........#...#...#...#...###.#.#.#...#...#.#.#...#...#.....#.......###...#...........#...#...#####...#.....#.....#...#...#...#.....###.#.###
###################.#########.#.#.#.#.#####.#.#.#.#.#######.#.#############.###########.#.#.#.#####.###.###.#####.#.#####.#.#######v###.#.###
#.................#...#...#...#.#.#.#.#...#.#.#.#.#.....#...#.###.........#.#.....#...#.#...#.#.....###...#...#...#.#...#.#...#...>.###...###
#.###############.###.#.#.#.###.#.#.#.#.#.#.#.#.#.#####.#.###v###.#######.#.#.###.#.#.#.#####.#.#########.###.#.###.#.#.#.###.#.###v#########
#...............#.....#.#.#...#.#.#.#.#.#.#.#...#...#...#...>.>.#.#.......#...#...#.#.#...#...#.....###...###.#...#.#.#.#...#.#.#...###.....#
###############.#######.#.###.#.#.#.#.#.#.#.#######.#.#######v#.#.#.###########.###.#.###.#.#######v###.#####.###.#.#.#.###.#.#.#.#####.###.#
#.....#...#.....#...###.#...#.#.#.#.#.#.#.#.....#...#.....###.#...#.#...#.......#...#.....#...#...>.>.#.....#.#...#.#.#.#...#.#.#.....#.#...#
#.###.#.#.#.#####.#v###.###.#.#.#.#.#.#.#.#####.#.#######.###.#####.#.#.#.#######.###########.#.###v#.#####.#.#.###.#.#.#.###.#.#####.#.#.###
#...#...#.#.....#.#.>...#...#.#.#.#.#.#.#.#...#.#...#.....#...#.....#.#.#.......#.........#...#.#...#.......#.#...#.#.#.#...#...#...#...#...#
###.#####.#####.#.#v#####.###v#.#.#.#.#.#.#.#.#.###.#.#####.###.#####.#.#######v#########.#.###.#.###########.###.#.#.#.###.#####.#.#######.#
###...#...#...#...#.#.....#.>.>.#.#.#.#.#.#.#.#.###...#...#...#.......#.#.....>.>...#...#.#...#.#.....###...#.#...#.#.#.#...#.....#.#.......#
#####.#.###.#.#####.#.#####.#v###.#.#.#.#.#.#.#.#######.#.###.#########.#.#####v###.#.#.#.###.#.#####.###.#.#.#.###.#.#.#.###.#####.#.#######
###...#...#.#.###...#.#...#.#...#.#.#.#.#.#.#.#.#.......#.###...###.....#.....#.###...#...#...#.....#...#.#.#.#.###...#.#.###.....#...###...#
###.#####.#.#.###.###.#.#.#.###.#.#.#.#.#.#.#.#.#.#######.#####.###.#########.#.###########.#######.###.#.#.#.#.#######.#.#######.#######.#.#
#...#...#...#...#.#...#.#...#...#...#.#.#...#...#.......#.#...#.#...#...#.....#...#...#...#.#...#...#...#.#.#...#.....#...#...###.......#.#.#
#.###.#.#######.#.#.###.#####.#######.#.###############.#.#.#.#.#.###.#.#.#######.#.#.#.#.#.#.#.#.###.###.#.#####.###.#####.#.#########.#.#.#
#...#.#.......#...#.....#.....#...###...#...#...#.......#...#.#.#...#.#.#...#...#...#.#.#.#...#...###...#.#...###.#...#.....#...........#.#.#
###.#.#######.###########.#####.#.#######.#.#.#.#.###########.#.###.#.#.###.#.#.#####.#.#.#############.#.###.###.#.###.#################.#.#
###.#.###...#...........#.......#.....#...#.#.#.#.#.......###.#...#.#.#...#.#.#.......#.#.#.........#...#.###...#.#.###.................#.#.#
###.#.###.#.###########.#############.#.###.#.#.#.#.#####.###.###.#.#.###.#.#.#########.#.#.#######.#.###.#####.#.#.###################.#.#.#
#...#.#...#.............###...........#.#...#.#...#.#.....#...#...#.#.#...#.#...........#.#.....#...#.....#...#...#.......#...###.......#.#.#
#.###.#.###################.###########.#.###.#####.#.#####.###.###.#.#.###.#############.#####.#.#########.#.###########.#.#.###.#######.#.#
#.....#...#...............#.#.....#.....#...#.......#...###.....###...#...#.#.............#...#.#.###...###.#.#...........#.#.#...#...###.#.#
#########.#.#############.#.#.###v#.#######.###########.#################.#.#.#############.#.#.#.###.#.###.#.#.###########.#.#.###.#.###.#.#
#...#...#...#...#.......#.#...#.>.>.#.......#...#...###.................#...#.........#.....#...#...#.#.....#...###...#...#.#.#...#.#...#.#.#
#.#.#.#.#####.#.#.#####.#.#####.#v###.#######.#.#.#.###################.#############.#.###########.#.#############.#.#.#.#.#.###v#.###.#.#.#
#.#...#.......#.#.....#...#...#.#...#.....###.#.#.#.#.....#.........#...###...........#.........#...#...........#...#.#.#...#...>.#...#.#.#.#
#.#############.#####.#####.#.#.###.#####.###.#.#.#.#.###.#.#######.#.#####.###################.#.#############v#.###.#.#########v###.#.#.#.#
#.............#.......#...#.#...#...#.....#...#...#.#...#...###...#...###...#...#...###.....#...#.#.....#.....>.>.#...#.#.......#.....#...#.#
#############.#########.#.#.#####.###.#####.#######.###.#######.#.#######.###.#.#.#.###.###.#.###.#.###.#.#####v###.###.#.#####.###########.#
#.............#...###...#.#.....#.#...#...#.....#...###...#...#.#.#.....#.....#...#...#...#...###.#...#...###...###.....#...###.#.....#...#.#
#.#############.#.###.###.#####.#.#.###.#.#####.#.#######.#.#.#.#.#.###.#############.###.#######.###.#######.#############.###.#.###.#.#.#.#
#.#...#...#.....#.....#...###...#.#...#.#.#...#.#.#...#...#.#.#.#.#.#...#...#...#...#...#.......#.#...#.......#...#...#####...#.#.#...#.#.#.#
#.#.#.#.#.#.###########.#####.###.###.#.#.#.#.#.#.#.#.#v###.#.#.#.#.#.###.#.#.#.#.#.###.#######.#.#.###.#######.#.#.#.#######.#.#.#.###.#.#.#
#...#...#...#...........#...#...#.###...#...#.#.#.#.#.>.>...#.#.#.#.#.#...#.#.#.#.#.###...#.....#...###.........#...#.#.......#...#.#...#.#.#
#############.###########.#.###.#.###########.#.#.#.###v#####.#.#.#.#.#.###.#.#.#.#.#####.#.#########################.#.###########.#.###.#.#
###...#...#...#...###...#.#.#...#.#...#.......#.#.#.###.....#.#.#.#.#.#...#.#.#.#.#.#...#.#.......#...#...#.....#...#.#.....#...###...###.#.#
###.#.#.#.#.###.#v###.#.#.#.#.###.#.#.#.#######.#.#.#######.#.#.#.#.#.###.#.#.#.#.#.#.#.#v#######.#.#.#.#.#.###.#.#.#.#####.#.#.#########.#.#
#...#...#.#.....#.>.#.#.#.#.#...#...#.#.......#.#.#.#.......#.#.#.#.#.#...#.#.#.#.#.#.#.>.>.#.....#.#.#.#...###.#.#...#...#...#.......###.#.#
#.#######.#######v#.#.#.#.#.###.#####.#######.#.#.#.#.#######.#.#.#.#.#.###.#.#.#.#.#.###v#.#.#####.#.#.#######.#.#####.#.###########.###.#.#
#.......#.#.....#.#.#.#...#.....#.....###.....#.#...#...#####...#...#.#...#.#.#.#.#...#...#.#.....#.#.#.......#.#.....#.#.............#...#.#
#######.#.#.###.#.#.#.###########.#######.#####.#######.#############.###.#.#.#.#.#####.###.#####.#.#.#######.#.#####.#.###############.###.#
#.......#.#.#...#.#.#.......#.....###...#.......###...#...#...#.....#...#.#.#.#.#.#.....###.......#.#...#.....#.#.....#...........#...#.....#
#.#######.#.#.###.#.#######.#.#######.#.###########.#.###.#.#.#.###.###.#.#.#.#.#.#.###############.###.#.#####.#.###############.#.#.#######
#.......#.#.#.###.#.#.......#.........#.....#.......#.....#.#...#...###...#...#...#...#####...#...#...#.#.....#...#...............#.#.......#
#######.#.#.#.###.#.#.#####################.#.#############.#####.###################.#####.#.#.#.###.#.#####.#####.###############.#######.#
#...#...#.#.#...#.#.#...#.....#.....#.....#.#.............#.....#...#...#.....#...###...###.#.#.#.#...#.#...#.....#.....#.....#.....#.......#
#.#.#v###.#.###.#.#.###.#.###.#.###.#.###.#.#############.#####.###.#.#.#.###.#.#.#####.###.#.#.#.#v###.#.#.#####.#####.#.###.#.#####.#######
#.#.#.>.#...#...#.#.#...#...#.#...#.#.###...#.............#...#.#...#.#.#.#...#.#.###...#...#.#.#.>.>.#...#.......#...#...#...#.#.....#...###
#.#.#v#.#####.###.#.#.#####.#.###.#.#.#######.#############.#.#.#.###.#.#.#.###.#.###v###.###.#.###v#.#############.#.#####.###.#.#####.#.###
#.#...#.....#.#...#...###...#...#.#...#...###...........#...#.#.#...#.#...#.#...#.#.>.>.#...#.#.#...#.........#...#.#...###.....#.......#...#
#.#########.#.#.#########.#####.#.#####.#.#############.#.###.#.###.#.#####.#.###.#.#v#.###.#.#.#.###########.#.#.#.###.###################.#
#.....#.....#...###.....#.....#.#.#...#.#.#...###...###.#...#.#.#...#...#...#...#...#.#.#...#...#.....#.......#.#.#...#.......#...#.........#
#####.#.###########.###.#####.#.#.#.#.#.#.#.#.###.#.###v###.#.#.#.#####.#.#####.#####.#.#.###########.#.#######.#.###.#######.#.#.#.#########
#.....#...#...#...#.#...#...#.#.#.#.#.#.#.#.#.#...#.#.>.>...#...#...#...#.......#.....#...#...........#...#.....#.#...#.....#...#...#####...#
#.#######.#.#.#.#.#.#.###.#.#.#.#v#.#.#.#.#.#.#.###.#.#v###########.#.###########.#########.#############.#.#####.#.###.###.#############.#.#
#.......#.#.#.#.#.#.#.#...#.#.#.>.>.#...#.#.#.#...#.#.#.#.........#.#...#...#...#.........#.............#.#.#.....#.....#...#...#.........#.#
#######.#.#.#.#.#.#.#.#.###.#.###v#######.#.#.###.#.#.#.#.#######.#.###.#.#.#.#.#########.#############.#.#.#.###########.###.#.#.#########.#
###.....#.#.#.#.#.#.#...#...#.###.#.....#.#.#.#...#.#.#...#.......#...#.#.#...#...........###.....###...#...#...#...#...#.....#...#.....#...#
###.#####.#.#.#.#.#.#####.###.###.#.###.#.#.#.#.###.#.#####.#########.#.#.###################.###.###.#########.#.#.#.#.###########.###.#.###
#...#...#...#.#.#.#.....#...#.###...#...#.#.#.#.#...#.#.....###...###...#...................#...#.....#.........#.#.#.#.###...#.....###...###
#.###.#.#####.#.#.#####.###.#.#######.###.#.#.#.#.###.#.#######.#.#########################.###.#######.#########.#.#.#.###v#.#.#############
#.....#...###...#.#...#.#...#.#.......###.#.#.#.#...#.#.......#.#.#.................#.......###.......#.....#...#.#...#...>.#.#.............#
#########.#######.#.#.#.#.###.#.#########.#.#.#.###.#.#######.#.#.#.###############.#.###############.#####.#.#.#.#########v#.#############.#
#.........#.....#...#.#.#...#.#.........#...#...###...#.......#.#.#.....#.........#.#.#...#...###...#.....#...#.#...#.......#...............#
#.#########.###.#####.#.###.#.#########.###############.#######.#.#####.#.#######.#.#.#.#.#.#.###.#.#####.#####.###.#.#######################
#...........#...#...#...###...#.........#...........#...#...###.#...###...###.....#...#.#.#.#.###.#.#.....#...#.#...#.......................#
#############.###.#.###########.#########.#########.#.###.#.###.###.#########.#########.#.#.#.###.#.#.#####.#.#.#.#########################.#
#.............#...#...#.........#...#...#...#.......#.....#.....#...#...#...#.....#.....#...#.#...#.#.......#.#...#.............#...#.......#
#.#############.#####.#.#########.#.#.#.###.#.###################.###.#.#.#.#####.#.#########.#.###.#########.#####.###########.#.#.#.#######
#.............#.#.....#.........#.#...#.....#.....###...#.........###.#.#.#.###...#.......#...#...#.#.........#...#.........###...#...#...###
#############.#.#.#############.#.###############.###.#.#.###########.#.#.#.###v#########.#.#####.#.#.#########.#.#########.###########.#.###
#.............#.#...#...#.....#.#.#.........#.....#...#.#.....#.....#.#...#.#.>.>...#.....#...#...#...#####...#.#.###.....#.....#...#...#...#
#.#############.###.#.#.#.###.#.#.#.#######.#.#####.###.#####.#.###.#.#####.#.#####.#.#######.#.###########.#.#.#.###.###.#####.#.#.#.#####.#
#.......###...#.#...#.#.#.#...#...#.......#.#.....#...#.......#.#...#.....#.#...###.#...#.....#...........#.#.#.#...#...#.....#...#.#.#.....#
#######.###.#.#.#.###.#.#.#.#############.#.#####.###.#########.#.#######.#.###.###.###.#.###############.#.#.#.###.###.#####.#####.#.#.#####
#.....#...#.#.#.#.#...#.#.#.#...#...#.....#.#.....#...#.........#...#.....#.....#...#...#...#.....#.......#.#.#.#...###.....#.......#.#.#...#
#.###.###.#.#.#.#.#.###.#.#.#.#.#.#.#.#####.#.#####.###.###########.#.###########.###.#####.#.###.#.#######.#.#.#.#########v#########.#.#.#.#
#...#.....#.#.#.#.#.#...#.#.#.#.#.#.#...###...#...#.....#...........#...........#.....#####...#...#.....#...#.#.#.....#...>.#...#...#.#...#.#
###.#######.#.#.#.#.#.###.#.#.#.#.#.###v#######.#.#######.#####################.###############.#######.#.###.#.#####.#.###v#.#.#.#.#.#####.#
###.......#.#.#.#.#.#.#...#.#.#.#.#...>.>.#...#.#.#.....#...#.....#...#.....#...#...#...........#...#...#.#...#.....#.#.#...#.#.#.#.#.#.....#
#########.#.#.#.#.#.#.#.###.#.#.#.#######.#.#.#.#.#.###.###.#.###.#.#.#.###.#.###.#.#.###########.#.#v###.#.#######.#.#.#.###.#.#.#.#.#.#####
#.........#.#...#.#.#.#.###...#.#.......#.#.#.#.#.#...#.###.#.#...#.#.#...#.#.....#.#.......#...#.#.>.>.#.#.......#.#...#...#.#.#.#...#.#...#
#.#########.#####.#.#.#.#######.#######.#.#.#.#.#.###.#.###v#.#.###.#.###.#.#######.#######.#.#.#.#####.#.#######.#.#######.#.#.#.#####.#.#.#
#.#.......#.#.....#.#.#.......#...#.....#...#.#.#...#.#.#.>.>.#...#.#.....#...#...#.###.....#.#.#...#...#.......#...###...#...#...#.....#.#.#
#.#.#####.#.#.#####.#.#######.###.#.#########.#.###.#.#.#.#######.#.#########.#.#.#.###.#####.#.###.#.#########.#######.#.#########.#####.#.#
#.#.#.....#.#.#...#.#...#...#.#...#...#.......#.#...#.#.#...#.....#.........#.#.#.#...#...#...#.#...#...#...#...#.......#...........#...#.#.#
#.#.#.#####.#.#.#.#.###.#.#.#.#.#####.#.#######.#.###.#.###.#.#############.#.#.#.###.###.#.###.#.#####.#.#.#.###.###################.#.#.#.#
#...#.......#...#...###...#...#.......#.........#.....#.....#...............#...#.....###...###...#####...#...###.....................#...#.#
###########################################################################################################################################.#"""


DIRS = {
    '<': (0, -1), '>': (0, 1), '^': (-1, 0), 'v': (1, 0)
}



def longest_path_Q(grid, slopes):
    n_rows, n_cols = len(grid), len(grid[0])
    path_len = []
    start_pos = (0, 1)
    end_pos = (n_rows - 1, n_cols - 2)
    queue = [(start_pos, 0, [])]

    print('Target', end_pos)

    while queue:
        p, cur_len, visited = queue.pop()
        if p == end_pos:
            # print('FOUND END', cur_len)
            # print(visited)
            path_len.append(cur_len)
        elif (p[0] < 0 or p[0] > n_rows - 1) or (p[1] < 0 or p[1] > n_cols -1) or (grid[p[0]][p[1]]) == '#' or (p in visited):
            continue
        else:
            # print('pos', p)
            visited.append(p)

            if slopes and grid[p[0]][p[1]] in DIRS:
                d = DIRS[grid[p[0]][p[1]]]
                queue.append(((p[0] + d[0], p[1] + d[1]), cur_len + 1, visited.copy()))
            else:
                next_len = cur_len + 1
                for d in DIRS.values():
                    queue.append(((p[0] + d[0], p[1] + d[1]), next_len, visited.copy()))

    print(path_len)
    return max(path_len)


def longest_path_R(grid):
    n_rows, n_cols = len(grid), len(grid[0])
    path_len = []
    start_pos = (0, 1)
    end_pos = (n_rows - 1, n_cols - 2)

    print('Target', end_pos)

    def find(p, cur_len, visited):
        if p == end_pos:
            print('FOUND END', cur_len)
            print(visited)
            path_len.append(cur_len)
        elif p[0] < 0 or p[0] > n_rows - 1 or p[1] < 0 or p[1] > n_cols - 1 or grid[p[0]][p[1]] == '#' or p in visited:
            return
        else:
            print('pos', p)
            visited.append(p)

            if grid[p[0]][p[1]] in DIRS:
                d = DIRS[grid[p[0]][p[1]]]
                find((p[0] + d[0], p[1] + d[1]), cur_len + 1, visited.copy())
            else:
                for d in DIRS.values():
                    find((p[0] + d[0], p[1] + d[1]), cur_len + 1, visited.copy())

    find(start_pos, 0, [])

    print(path_len)

    return max(path_len)


def part1():
    grid = list(map(list, tdata.splitlines()))
    print("Part 1:", longest_path_Q(grid, slopes=True))
    grid = list(map(list, data.splitlines()))
    print("Part 1:", longest_path_Q(grid, slopes=True))

def part2():
    grid = list(map(list, tdata.splitlines()))
    print("Part 2:", longest_path_Q(grid, slopes=False))
    grid = list(map(list, data.splitlines()))
    print("Part 2:", longest_path_Q(grid, slopes=False))


if __name__ == '__main__':
    part1()
    part2()
